<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><meta name="last modified" content="27/09/2021 12:47:24"><meta name=abstract content><meta name=author content="dpavel@vmware.com"><meta name=primary-product-name content="MD2Docs-TestBed"><meta name=primary-product-version content="1"><meta name=description content><meta name=guid content="GUID-1Intro"><meta name=language content="en"><meta name=title content="Basic Markdown"><meta name=publication-author content="dpavel@vmware.com"><meta property="og:title" content="Basic Markdown"><meta property="og:image" content="https://docs-uat.vmware.com/uicontent/images/vmware-docs-default.png"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:locale" content="en"><meta property="og:url" content="https://docs-uat-staging.vmware.com/en/MD2Docs-TestBed/1/md-2-docs-test-bed/GUID-1Intro.html"><meta name=cdf-utag content="https://tags.tiqcdn.com/utag/vmware/cdf-privacy/qa/utag.js"><link rel=stylesheet type=text/css href=/validated-solutions/css/commonltr.css><link rel=stylesheet type=text/css href=/validated-solutions/css/non-draft.vmware.productdocs.css><link rel=canonical href=https://docs-uat-staging.vmware.com/en/MD2Docs-TestBed/1/md-2-docs-test-bed/GUID-1Intro.html><link class=user href=/validated-solutions/css/responsive.css rel=stylesheet type=text/css><link rel=icon href=https://www.vmware.com/favicon.ico type=image/x-icon><link rel=stylesheet href=/validated-solutions/css/v2-global.20200911172508.css><title>Docs Preview</title></head><body><header class=tech-pub-header><div id=header class="global-header col-12"><div class="row desktop-header h-100"><div class="col col-md-3 align-self-center header-logo-wrapper"><div class="d-inline-flex align-items-center justify-content-start w-100"><div class="d-inline-flex align-items-center w-100"><span class="my-auto d-md-none header-menu-icon"><i class="fa fa-bars"></i></span><h1><a href=https://docs-uat-staging.vmware.com/ class="d-inline-flex align-items-center my-auto nav-link header-logo-url pl-md-1 pl-xl-3"><span class=mr-2><img src=/validated-solutions/img/vm-logo.png alt="VMware Logo"></span>
<span class=vm-logo-title>Docs Preview</span></a></h1></div><div class=align-items-center><span id=toggleTOC class="d-md-none header-toc-icon"><i class="fa fa-ellipsis-v px-2"></i></span></div></div></div></div></div><div class="col-12 vmware-gradient w-100 px-0 mx-0"></div></header><div class="tech-pub-container main-container d-flex flex-column pubView"><section class="tech-pub-section d-flex flex-md-row"><div class="lhs lhs-container col-md-4 col-lg-3" style=display:block><div class=backdrop></div><div class=left-panel><div class="panel-header position-relative hidden-xs"><div class="panel-header-left d-flex justify-content-between align-items-center"><span class=container-collapse-expand><span id=expand-all-id class=expand-tree onclick=expandAll()><span class="lhs-expand-shape align-middle"><i class="fa fa-chevron-down"></i></span>
<span class="expand-text align-middle" data-i18n data-i18n-expand-all>Expand All</span></span>
<span id=collapse-all-id class="collapse-tree hide" onclick=collapseAll()><span class="lhs-collapse-shape align-middle"><i class="fa fa-chevron-up"></i></span>
<span class="collapse-text align-middle" data-i18n data-i18n-collapse-all>Collapse All</span></span></span></div></div><div class="panel-content p-2" id=left_toc><div class="dropdown collection-dropdown-container w-100"><button class="btn w-100 text-left dropdown-toggle collection-name" type=button id=collectionDropdwnBtn data-toggle=dropdown aria-haspopup=true aria-label="Collection Dropdown" aria-expanded=false>
<span class=label></span>
<span class="float-right icon-down pl-2 fa fa-angle-down"></span></button><div class="dropdown-menu w-100" id=collectionMenu aria-labelledby=collectionDropdwnBtn></div></div><div id=tree class=mt-2></div><div class="w-100 px-2 toc-product-container"><a class="mr-3 my-2 position-relative toc-product-link"><span class=toc-product-name></span>
<span class=localized-page-name>Product Documentation</span></a></div><ul class=rm-default-ul-styles></ul></div></div></div><div class="rhs rhs-container col-md-8 col-lg-7" style=display:block><div class=rhs-top><div class="rhs-top-container-top d-flex flex-row justify-content-between"><h1 class=primary-header id=enable-data-protection-on-a-workload-cluster-and-configure-backup>Enable Data Protection on a Workload Cluster and Configure Backup</h1></div><div class="rhs-top-container-middle d-flex flex-row justify-content-between"></div><div class=rhs-top-container-bottom><div class=last-updated-container><div class=calendar-icon><svg width="36" height="36" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path class="clr-i-outline clr-i-outline-path-1" d="M32.25 6H29V8h3V30H4V8H7V6H3.75A1.78 1.78.0 002 7.81V30.19A1.78 1.78.0 003.75 32h28.5A1.78 1.78.0 0034 30.19V7.81A1.78 1.78.0 0032.25 6z"/><rect class="clr-i-outline clr-i-outline-path-2" x="8" y="14" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-3" x="14" y="14" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-4" x="20" y="14" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-5" x="26" y="14" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-6" x="8" y="19" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-7" x="14" y="19" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-8" x="20" y="19" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-9" x="26" y="19" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-10" x="8" y="24" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-11" x="14" y="24" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-12" x="20" y="24" width="2" height="2"/><rect class="clr-i-outline clr-i-outline-path-13" x="26" y="24" width="2" height="2"/><path class="clr-i-outline clr-i-outline-path-14" d="M10 10a1 1 0 001-1V3A1 1 0 009 3V9a1 1 0 001 1z"/><path class="clr-i-outline clr-i-outline-path-15" d="M26 10a1 1 0 001-1V3a1 1 0 00-2 0V9a1 1 0 001 1z"/><rect class="clr-i-outline clr-i-outline-path-16" x="13" y="6" width="10" height="2"/><rect x="0" y="0" width="36" height="36" fill-opacity="0"/></svg></div><span class=last-updated-label data-i18n-updated-on>Updated on</span>
&nbsp;
<span class=last-updated-date-ph>9/22/22</span></div></div></div><div class="rhs-center article-wrapper" id=content-div-id><h1 id=enable-data-protection-on-a-workload-cluster-and-configure-backup>Enable Data Protection on a Workload Cluster and Configure Backup</h1><p>You can run backup and restore operations in Tanzu Mission Control to protect your Kubernetes data.</p><h2 id=prerequisites>Prerequisites</h2><p>Before you enable Data Protection on a workload cluster, ensure the following prerequisites:</p><ul><li><p>You have an active Tanzu Mission Control subscription.</p></li><li><p>The workload cluster that you want to protect is registered or attached with Tanzu Mission Control.</p></li><li><p>You have created a credential for Data Protection as per instructions provided in the Tanzu Mission Control <a href=https://docs.vmware.com/en/VMware-Tanzu-Mission-Control/services/tanzumc-using/GUID-4F349EE4-9C64-4243-84FF-D287F497A3D0.html>documentation</a>.</p></li><li><p>You have created a Target Location for Data Protection as per instructions provided in the Tanzu Mission Control <a href=https://docs.vmware.com/en/VMware-Tanzu-Mission-Control/services/tanzumc-using/GUID-867683CE-8AF0-4DC7-9121-81AD507EDB3B.html>documentation</a>.</p></li></ul><p>For more information about protecting the data resources in your Kubernetes clusters, see Data Protection in <a href=https://docs.vmware.com/en/VMware-Tanzu-Mission-Control/services/tanzumc-concepts/GUID-C16557BC-EB1B-4414-8E63-28AD92E0CAE5.html>VMware Tanzu Mission Control Concepts</a>.</p><h2 id=enable-data-protection-on-workload-cluster>Enable Data Protection on Workload Cluster</h2><p>To enable data protection on a workload cluster,</p><ol><li><p>Locate the cluster in the Tanzu Mission Control portal and click on the Overview tab.</p></li><li><p>In the <strong>Data protection</strong> section, click <strong>Enable Data Protection</strong>.</p><p><img src=img/tko-data-protection/tko-dp01.png alt="Tanzu Mission Control Overview"></p></li><li><p>Click <strong>Enable</strong> on the confirmation dialog.</p><p><img src=img/tko-data-protection/tko-dp02.png alt="Enable data protection dialog"></p></li></ol><p>It takes approximately 5-10 minutes to enable data protection on a Kubernetes cluster. Tanzu Mission Control creates a namespace named Velero and installs Velero related Kubernetes objects in the workload cluster.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@arcas <span style=color:#f92672>[</span> ~ <span style=color:#f92672>]</span><span style=color:#75715e># kubectl get all -n velero</span>
</span></span><span style=display:flex><span>NAME                          READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>pod/restic-nfbpl              1/1     Running   <span style=color:#ae81ff>0</span>          44s
</span></span><span style=display:flex><span>pod/restic-q57nk              1/1     Running   <span style=color:#ae81ff>0</span>          44s
</span></span><span style=display:flex><span>pod/restic-sj954              1/1     Running   <span style=color:#ae81ff>0</span>          44s
</span></span><span style=display:flex><span>pod/velero-57cdf5f99f-7fn4b   1/1     Running   <span style=color:#ae81ff>0</span>          71s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME                    DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE
</span></span><span style=display:flex><span>daemonset.apps/restic   <span style=color:#ae81ff>3</span>         <span style=color:#ae81ff>3</span>         <span style=color:#ae81ff>3</span>       <span style=color:#ae81ff>3</span>            <span style=color:#ae81ff>3</span>           &lt;none&gt;          45s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME                     READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span style=display:flex><span>deployment.apps/velero   1/1     <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>1</span>           71s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NAME                                DESIRED   CURRENT   READY   AGE
</span></span><span style=display:flex><span>replicaset.apps/velero-57cdf5f99f   <span style=color:#ae81ff>1</span>         <span style=color:#ae81ff>1</span>         <span style=color:#ae81ff>1</span>       72s
</span></span></code></pre></div><h2 id=configure-backup>Configure Backup</h2><p>After enabling data protection,</p><ol><li><p>In the <strong>Data protection</strong> section, click <strong>Create Backup</strong> to configure backup for the workload cluster.</p><p><img src=img/tko-data-protection/tko-dp03.png alt="Tanzu Mission Control Overview"></p><p>Tanzu Mission Control Data Protection allows you to create backups of the following types:</p><ul><li>All resources in a cluster.</li><li>Selected namespaces in a cluster.</li><li>Specific resources in a cluster identified by a given label.</li></ul><p><img src=img/tko-data-protection/tko-dp04.png alt="Create backup dialog - Backup source"></p></li><li><p>Select the target location where the backup will be stored.</p><p><img src=img/tko-data-protection/tko-dp05.png alt="Create backup dialog - Backup target location"></p></li><li><p>Configure the backup schedule and click <strong>Next</strong>.</p><p><img src=img/tko-data-protection/tko-dp06.png alt="Create backup dialog - Backup schedule"></p></li><li><p>Specify the backup retention period and click <strong>Next</strong>.</p><p><img src=img/tko-data-protection/tko-dp07.png alt="Create backup dialog - Backup retention period"></p></li><li><p>Specify a name for the backup schedule and click <strong>Create</strong>.</p><p><img src=img/tko-data-protection/tko-dp08.png alt="Create backup dialog - Specify backup name and create"></p></li></ol><p>Backup configuration may take some time depending on the Kubernetes objects that you have provisioned in the workload cluster. When backup is configured for the first time, Tanzu Mission Control takes a backup immediately. After that backups are taken as per the backup schedule configured.</p><p><img src=img/tko-data-protection/tko-dp09.png alt="Tanzu Mission Control - Backups and schedules "></p><h2 id=restore-backup>Restore Backup</h2><p>To restore the Kubernetes data from the backup,</p><ol><li><p>Go to <strong>Data Protection</strong>.</p></li><li><p>Select the backup image and click <strong>Restore</strong>.</p><p><img src=img/tko-data-protection/tko-dp10.png alt="Restore backup image"></p></li><li><p>Select the resources that you want to restore.</p><p><img src=img/tko-data-protection/tko-dp11.png alt="Select resources for restoring"></p></li><li><p>Specify a name for the restore task and click <strong>Restore</strong>.</p><p><img src=img/tko-data-protection/tko-dp12.png alt="Specify restore task name"></p></li></ol><p>If you have backed up persistent volumes, the restore process may take some time. The backup is restored in the same cluster from which it was retrieved.</p></div></div><div class="loader-container-toc col-lg-2 w-100" style=display:none><span class=spinner></span></div><div class="rhs-right-container d-none d-lg-block col-lg-2"><div class=rhs-right-panel><div class="rhs-right-panel-header d-flex justify-content-between"><div class=rhs-right-panel-title>In this article</div></div><div id=right-toc-div-id class="onpage-toc-container d-flex flex-column"><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#enable-data-protection-on-workload-cluster>Enable Data Protection on Workload Cluster</a></li><li><a href=#configure-backup>Configure Backup</a></li><li><a href=#restore-backup>Restore Backup</a></li></ul></nav></div></div></div></section></div><footer class=tech-pub-footer><div id=page-footer><section class="footer-component footer-container"><div class=personalization_div_1 style=min-height:1px></div><div class=personalization_div_2 style=min-height:1px></div><div class=container><div class=content><div class=row><div class="col-lg-12 col-md-12"><footer class=footer><div class=row><div class="col-lg-2 col-md-12 mb-40 mt-3"><a class=footer-vmware-logo href=https://www-lt.vmware.com/ name="nav_footer : VMware Logo"><picture class=float-lg-left><source media=(max-width:800px) srcset=https://www-lt.vmware.com/content/dam/digitalmarketing/vmware/vm-logo-big.png.imgo.jpeg><img loading=lazy class=vmware-logo src=/validated-solutions/img/vm-logo-big.png alt=VMware title=VMware></picture></a></div></div></footer></div></div></div></div></section></div></footer><script src=/validated-solutions/js/pageStore.js></script>
<script src=/validated-solutions/js/main.js></script></body></html>